<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Large-Model inference on Mac | Santacloud</title>
<meta property="og:title" content="Large-Model inference on Mac | Santacloud" />
<meta name="twitter:title" content="Large-Model inference on Mac | Santacloud" />
<meta itemprop="name" content="Large-Model inference on Mac | Santacloud" />
<meta name="application-name" content="Large-Model inference on Mac | Santacloud" />
<meta property="og:site_name" content="Santacloud" />

<meta name="description" content="A blog about tech stuff">
<meta itemprop="description" content="A blog about tech stuff" />
<meta property="og:description" content="A blog about tech stuff" />
<meta name="twitter:description" content="A blog about tech stuff" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/posts/large-model-inference-on-mac/" title="" />



  <meta itemprop="image" content="http://localhost:1313/" />
  <meta property="og:image" content="http://localhost:1313/" />
  <meta name="twitter:image" content="http://localhost:1313/" />
  <meta name="twitter:image:src" content="http://localhost:1313/" />




    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-07-06T11:06:24&#43;0300 />
    <meta property="article:published_time" content=2024-07-06T11:06:24&#43;0300 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Large-Model inference on Mac",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-07-06",
        "description": "",
        "wordCount":  550 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-07-06",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Santacloud"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.128.2">

    

    <link rel="canonical" href="http://localhost:1313/posts/large-model-inference-on-mac/">
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Large-Model inference on Mac</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-07-06T11:06:24&#43;03:00" itemprop="datePublished"> Jul 6, 2024
                    </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p>This is a log of my journey on how do large-model inference on my Macbook, rather than having to use a cloud service or buying an expensive PC with a more expensive GPU. And then seeing how fast I can make it go.</p>
<h2 id="introduction">Introduction</h2>
<p>So in case you haven&rsquo;t noticed - everybody&rsquo;s talking about AI. And as a software developer, I wanted to test some stuff out and play around with different frameworks, methods, algorithms. But the thing is, that like a lot of developers, I own a Macbook. And to my surprise almost <strong>NOTHING</strong> is supported, and you&rsquo;re just stuck with &ldquo;Oh well, this is for data scientists and it requires a GPU and/or the cloud&hellip; so either buy those or leave the job to the pros&rdquo;. That bothered me.</p>
<p>I mean, I&rsquo;ve been a software developer since 2nd grade, I tinker with things. We didn&rsquo;t have resources then and we made things works. Why shouldn&rsquo;t this be the case now?
When I got my first Macbook somewhere around 8 years ago from one of my earlier jobs, I was surprised by the product efficiency and quality - and only looked back once when they had that god-awful flat keyboard somewhere around 2020. I&rsquo;ve used this Macbook to design things in 3D, played games, and created some pretty great software on this machine. This is a great piece of technology with the Apple Silicon chip, with both a CPU and GPU, and it performs like a champ.
And then comes this thing, which is basically running a freaking program, and suddenly that is &ldquo;Data Science&rdquo; domain. Doesn&rsquo;t seem right. I think that (generally speaking) I should be able to use this machine to tinker and work and try out new things. And from that tinkering there might come great things, with great value and scale for other people.</p>
<p>I&rsquo;m a firm believer that innovation comes from constraints, rather than abundance. Constraints make you think outside the box.
And I wanted to see how much I could push it. I wanted to learn.</p>
<h2 id="initial-research-of-existing-solutions">Initial research of existing solutions</h2>
<p>After some investigation (and a lot of trials with a lot of different tools and engine), I came up with:</p>
<ul>
<li><b>llama.cpp</b> - lets you run some models using MacOS that works <strong>great(!)</strong> but it wasn&rsquo;t easily hackable with its insane llama.cpp file, and I wanted to experiment with different optimization algorithms (and perhaps try some of my own)</li>
<li><b>Ollama</b> - lets you play around with some models, and its very high level just inferencing (and it uses llama.cpp under the hood). This makes llama.cpp more approachable with a <b>Docker</b>-like experience (which is awesome). But still you have no control over the actual throughput of inference.</li>
<li>Using paid serverless GPU providers like <b>Modal</b> or <b>baseten</b> - I wanted to be able to run stuff and iterate locally, and this just doesn&rsquo;t do that. I&rsquo;m sure that these solutions are great, but this failed to meet my criteria. Also I hate DSLs for deployment.</li>
<li><b>Google Colab</b> - playing around with actual code with model, however - in their extremely janky notebook experience, and also it&rsquo;s on somebody else&rsquo;s machine.</li>
</ul>
<p><strong>Not viable for Macs (or somewhat viable, but REALLY slow and inefficient):</strong></p>
<ul>
<li><b>DeepSpeed-MII</b></li>
<li><b>CTranslate2</b></li>
<li><b>vLLM</b></li>
<li><b>pytorch</b></li>
<li><b>text-generation-inference</b></li>
</ul>
<h2 id="what-language-to-pick">What language to pick?</h2>
<p>This was another consideration</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/thesantacloud" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://x.com/thesantacloud" target="_blank" rel="noopener noreferrer me"
    title="X">
    <svg viewBox="0 0 1200 1227" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path
        d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
</svg>
</a>
<a href="dor@santacloud.dev" target="_blank" rel="noopener noreferrer me"
    title="Email">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a>
</div>
    <small class="footer_copyright">
        Â© 2024 Dor Munis.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
